##############################
#                            #
# Ansible / Tower managed on #
#                            #
##############################

[galera]
# Mandatory Options
wsrep_on=ON
wsrep_provider=/usr/lib/galera/libgalera_smm.so
wsrep_cluster_name="{{ install_mariadb_galera_clustername }}"
wsrep_node_name="{{ install_mariadb_galera_node_name }}"
wsrep_sst_method=rsync
binlog_format=row
default_storage_engine=InnoDB
innodb_autoinc_lock_mode=2
innodb_buffer_pool_size=128M

# Network Ports
wsrep_node_address="{{ install_mariadb_galera_node_address }}"
bind-address="{{ install_mariadb_bind_address }}"
wsrep_cluster_address="gcomm://{{ install_mariadb_galera_node_list }}"

{% if install_mariadb_ssl | default(false) %}
# SSL/TLS & mTLS
wsrep_provider_options="socket.ssl"
{% if install_mariadb_ssl_client_auth | default(false) %}
wsrep_provider_options="socket.ssl_ca={{ install_mariadb_ssl_ca }}"
{% endif %}
wsrep_provider_options="socket.ssl_cert={{ install_mariadb_ssl_cert }}"
wsrep_provider_options="socket.ssl_key={{ install_mariadb_ssl_key }}"
{% endif %}
